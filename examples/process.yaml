name: Process Commands
description: Process inspection and management (beyond top/htop)

commands:
  # Process listing with different views
  - name: ps by memory
    command: ps
    args: ["aux", "--sort=-%mem"]
    description: List processes sorted by memory usage (highest first)

  - name: ps by cpu
    command: ps
    args: ["aux", "--sort=-%cpu"]
    description: List processes sorted by CPU usage (highest first)

  - name: ps tree
    command: ps
    args: ["auxf"]
    description: Show process tree with hierarchy

  - name: ps by user
    command: ps
    args: ["-u", "{{user}}", "-o", "pid,ppid,%cpu,%mem,stat,start,time,command"]
    description: List processes for specific user

  # Finding processes
  - name: pgrep find
    command: pgrep
    args: ["-la", "{{pattern}}"]
    description: Find processes matching pattern (shows PID and command)

  - name: pidof
    command: pidof
    args: ["{{name}}"]
    description: Get PID of running program by exact name

  # Process details
  - name: proc info
    command: ps
    args: ["-p", "{{pid}}", "-o", "pid,ppid,user,%cpu,%mem,vsz,rss,stat,start,time,command"]
    description: Detailed info for specific PID
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  - name: proc files
    command: lsof
    args: ["-p", "{{pid}}"]
    description: List all files opened by process
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  - name: proc network
    command: ss
    args: ["-tunap"]
    description: Show all network connections with process info

  - name: proc ports
    command: ss
    args: ["-tlnp"]
    description: Show listening ports with process names

  - name: proc env
    command: cat
    args: ["/proc/{{pid}}/environ"]
    description: Show environment variables of process (null-separated)
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  - name: proc cmdline
    command: cat
    args: ["/proc/{{pid}}/cmdline"]
    description: Show full command line of process
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  - name: proc fd
    command: ls
    args: ["-la", "/proc/{{pid}}/fd"]
    description: List file descriptors of process
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  # Process management
  - name: kill graceful
    command: kill
    args: ["-15", "{{pid}}"]
    description: Send SIGTERM to process (graceful shutdown)
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  - name: kill force
    command: kill
    args: ["-9", "{{pid}}"]
    description: Send SIGKILL to process (force kill)
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  - name: pkill name
    command: pkill
    args: ["{{pattern}}"]
    description: Kill processes matching pattern

  # Resource monitoring
  - name: proc io
    command: sudo
    args: ["iotop", "-o", "-P"]
    description: Show I/O usage by process (only active)

  - name: proc watch
    command: watch
    args: ["-n", "1", "ps", "-p", "{{pid}}", "-o", "pid,%cpu,%mem,rss,vsz,stat,time"]
    description: Watch process stats every second
    placeholders:
      pid:
        source: "ps -eo pid,comm --no-headers | awk '{print $1, $2}'"

  # System-wide
  - name: proc count
    command: sh
    args: ["-c", "ps aux | wc -l"]
    description: Count total running processes

  - name: proc zombies
    command: ps
    args: ["aux"]
    description: Find zombie processes (look for Z in STAT column)
